<% layout('layout/boilerplate') -%>


<div class="container mt-5 card-container ">
  <div class="card shadow rounded-4 profile-page futuristic-border">
    <div class="card-body p-0">
      

      <div class="banner" style="height: 200px; position: relative;">

        <img src="<%= user.profilePicture.url %>" id="profile-avatar" class="rounded-circle  img-fluid " 
             style="width: 120px; height: 120px; position: absolute; bottom: -60px; left: 30px;" alt="User Avatar">
      </div>


      <div class="p-4 pt-5">
        <div class="d-flex justify-content-between align-items-start">
          <div>
            <h4 class="mb-0"> <%= user.username %></h4>
            <small class="text-muted"></small>
          </div>
          <div class="buttons">
              <div class="me-3">
              <form action="/<%= user.id %>/profile/delete?_method=DELETE", method="POST">
                  <button type="submit" class="btn btn-dark profile-btn">Delete Profile</button>
              </form>
              </div>
              <div>
                  <button class="btn btn-dark profile-btn">Edit Profile</button>
              </div>
          </div>
        </div>
        <div class="bio mt-3">
            <form action="/edit/profile?_method=PATCH" method="POST" enctype="multipart/form-data">
                <div class=" mb-5 me-2">
                    <label class="form-label" for="image" style="color: white;">Update Profile Picture</label>
                    <br>
                    <input type="file" class="form-control" name="profilePic" id="profilePic">
                </div>
                <textarea name="bioText" id="bioText" placeholder="Enter Text" maxlength="160"> <%= user.bio %></textarea>
                <div class="mt-4">
                    <button type="submit" class="btn btn-dark">Update</button>
                </div>
            </form>
        </div>
        <p class="mt-3"></p>


        <div class="d-flex gap-4">
          <div><strong><%= user.posts.length %></strong> Posts</div>
        </div>
      </div>
      <hr class="my-0">


      <div class="row row-cols-1 row-cols-md-3 g-2 p-3">
        <% for(let post of user.posts){ %>
            <div class="col-4">
                <div class=" thought profile-thought">
                    <div class="delete-header">
                        <form action="/<%= post.id %>/removethought?_method=DELETE" method="POST"><button id="simpleX" type="submit">X</button></form>
                    </div>
                    <div class="thought-headline ">
                        <div class="avatar ">
                            <img src="<%= user.profilePicture.url %>" class="img-fluid userIcon"alt="User Icon">
                        </div>
                        <a href=""style="text-decoration: none" class="mt-3 userLink"><%= user.username %> </a>
                    </div>
                    <div class="thought-body mt-4">
                        <%= post.text %>
                    </div>
                    <div class="time-div mt-4">
                        <div>
                            <%=post.dateCreated %>
                        </div>
                    </div>
                </div>
            </div>
            <% } %>
        </div>
      </div>

    </div>
  </div>
</div>
